<!DOCTYPE html>

<html>
  <head>
    <title>Phần mềm Chấm điểm Taekwondo | Chấm điểm Taekwondo NTU</title>
    <meta http-equiv="Content-Type" content="text/html; CHARSET=UTF-8" />
    <link rel="shortcut icon" type="image/x-icon" href="./favicon.ico" />
    <link rel="stylesheet" type="text/css" href="./style.css" />
    <script type="text/javascript">
      /*
		Nút hiện tại:
		- > bắt đầu, tiếp tục
		- < tạm dừng săn sóc, nếu hết 60s thì kết thúc trận đấu
		- ; tạm dừng xem xét
		Thay đổi các phím bấm ở đây
	*/
      const aDefKeys = new Array(
        56,
        55,
        50,
        51,
        52,
        49,
        73,
        85,
        87,
        69,
        82,
        81,
        75,
        74,
        83,
        68,
        70,
        65,
        188,
        77,
        88,
        67,
        86,
        90,
        109,
        80,
        84,
        71,
        66,
        78,
        59,
        48,
        53,
        107,
        219
      );
      const I_MAX_LOI = 10;
      //Array(55, 50, 52, 49, 51, 56, 83, 65, 70, 75, 68, 74, 77, 188, 90, 67, 86, 88, 73, 81, 69, 85, 82, 87, 109, 107, 57, 48, 219, 221, 79, 80, 190, 76, 59);
      var oCurrCtrl = null;
      var sMatchX1 = '';
      var sMatchX2 = '';
      var sMatchX3 = '';
      var sMatchD1 = '';
      var sMatchD2 = '';
      var sMatchD3 = '';
      var sMatchX21 = '';
      var sMatchX22 = '';
      var sMatchX23 = '';
      var sMatchD21 = '';
      var sMatchD22 = '';
      var sMatchD23 = '';
      var iAdded = 0;
      var iAdded2 = 0;
      var iTruX = 0;
      var iTruD = 0;

      // Thời gian mỗi hiệp tính theo giây. Ví dụ: 2 phút là 120s
      var iTimeFight = 120;
      var iTimeLeft = iTimeFight;
      var bTickOn = true;
      var bIsFighting = false;
      var bInBreak = false;
      var bPause = false;
      var bPauseType = '';
      var iPauseTime = 0;
      var bPauseTick = true;
      var iRoundCount = 1;
      var iBtlCount = 1;
      var iDau = 0;
      var iCuoi = 0;
      var iToiDa = 40;
      var aMt = new Array(); // t1
      var aMStatus = new Array(); // 0: Không có gì; 1: Đang khớp phím; 2: Kết thúc khớp phím
      var aMGroup = new Array(); // 0: Mặt; 1: Bụng; 2: Khó
      var aMVDV = new Array(); // D: Đỏ, X: Xanh
      var aMKey = new Array(); // Lưu iNum
      var aMCount = new Array(); // Số lần khớp
      var aDHien = Array(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0); // Số lần bấm phím bên Đỏ của trọng tài
      var aXHien = Array(0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0); // Số lần bấm phím bên Xanh của trọng tài
      var aNhom = Array('mat', 'bung', 'kho');
      var t2;
      var oDisplay = null;
      var oDisplay2 = null;
      const aCtrl = Array(
        'PhimD12',
        'PhimXTru',
        'PhimXCong',
        'PhimDTru',
        'PhimDCong', // 0, 1, 2, 3, 4
        'PhimXTruDiem',
        'PhimXCongDiem',
        'PhimDTruDiem',
        'PhimDCongDiem', // 5, 6, 7, 8
        'PhimBatDau',
        'PhimDungSS',
        'PhimDungXX'
      ); //9, 10, 11

      // Statistic score
      let headScoreRed = null;
      let bodyScoreRed = null;
      let glovesScoreRed = null;

      let headScoreBlue = null;
      let bodyScoreBlue = null;
      let glovesScoreBlue = null;

      let pointCount = 0;
      let pointTimer = null;
      // Statistic score

      function showDebug(sText, bCont) {
        if (oDisplay.document.getElementById('Debug')) {
          if (!bCont) oDisplay.document.getElementById('Debug').value = '';
          oDisplay.document.getElementById('Debug').value += sText;
        }
      }

      function onFocus(oCtrl) {
        if (oCtrl.name.indexOf('Phim') >= 0) {
          oCurrCtrl = oCtrl;
        } else {
          oCurrCtrl = null;
        }

        if (
          oCtrl.name.indexOf('TrongTai') >= 0 ||
          oCtrl.name.indexOf('Diem') >= 0 ||
          oCtrl.name.indexOf('Tru') >= 0
        )
          oCtrl.blur();
      }

      function onKeyDown(event, sType) {
        if (sType == 'up') {
          if (ChamDiem.elements[aCtrl[1]].value == event.keyCode)
            decrease('X', false);
          if (ChamDiem.elements[aCtrl[2]].value == event.keyCode)
            decrease('X', true);
          if (ChamDiem.elements[aCtrl[3]].value == event.keyCode)
            decrease('D', false);
          if (ChamDiem.elements[aCtrl[4]].value == event.keyCode)
            decrease('D', true);
          if (ChamDiem.elements[aCtrl[5]].value == event.keyCode)
            modify('X', 1);
          if (ChamDiem.elements[aCtrl[6]].value == event.keyCode)
            modify('X', -1);
          if (ChamDiem.elements[aCtrl[7]].value == event.keyCode)
            modify('D', 1);
          if (ChamDiem.elements[aCtrl[8]].value == event.keyCode)
            modify('D', -1);
        }

        if (sType == 'up' && bIsFighting && !bInBreak) {
          if (!bPause) {
            for (var i = 1; i <= 12; i++) {
              // 12 = 3 * 4
              if (ChamDiem.elements['PhimX' + i].value == event.keyCode)
                setMatch(i, 'X');
              if (ChamDiem.elements['PhimD' + i].value == event.keyCode)
                setMatch(i, 'D');
            }
          }
          return;
        }

        if (
          sType == 'up' &&
          ChamDiem.elements[aCtrl[9]].value == event.keyCode &&
          !bIsFighting
        ) {
          // Why two lines of HTML are here???
          if (!bIsFighting) startFight();
        } else if (
          sType == 'down' &&
          ChamDiem.elements[aCtrl[9]].value == event.keyCode &&
          bPause &&
          bIsFighting &&
          !bInBreak
        ) {
          // Continue fighting
          bPause = !bPause;
          showInfo('HangCan');
        } else if (
          sType == 'down' &&
          ChamDiem.elements[aCtrl[10]].value == event.keyCode &&
          bIsFighting &&
          !bInBreak
        ) {
          // Pause with 1 minute limit (San Soc)
          bPause = !bPause;
          setPause('ss');
        } else if (
          sType == 'down' &&
          ChamDiem.elements[aCtrl[11]].value == event.keyCode &&
          bIsFighting &&
          !bInBreak
        ) {
          // Pause with no limit (Xem Xet)
          bPause = !bPause;
          setPause('xx');
        } else if (oCurrCtrl && sType == 'up' && !bIsFighting)
          setKey(oCurrCtrl, event.keyCode);
      }

      function setPause(sType) {
        if (!bPause) {
          showInfo('HangCan');
          showInfo('GioiTinh');
          document.getElementById('DungSS').disabled = false;
          document.getElementById('DungXX').disabled = false;
          return;
        }

        bPauseType = sType;

        // Dừng săn sóc 60 giây
        if (sType == 'ss') {
          iPauseTime = 60;
          document.getElementById('DungXX').disabled = true;
          document.getElementById('GioiTinh').innerHTML = 'SĂN SÓC';
          duplicateDisplay('GioiTinh');
          return;
        }

        // Dừng xem xét
        if (sType == 'xx') {
          iPauseTime = 0;
          document.getElementById('DungSS').disabled = true;
          document.getElementById('GioiTinh').innerHTML = 'XEM XÉT';
          duplicateDisplay('GioiTinh');
        }
      }

      function resetPause() {
        bPause = false;
        bPauseType = '';
        iPauseTime = 0;
        bPauseTick = true;
        setPause('');
      }

      function setKey(oCtrl, iKey) {
        for (var i = 1; i <= 12; i++) {
          if (
            'PhimX' + i != oCtrl.name &&
            ChamDiem.elements['PhimX' + i].value == iKey
          )
            // Clear conflict key
            ChamDiem.elements['PhimX' + i].value = '';
          if (
            'PhimD' + i != oCtrl.name &&
            ChamDiem.elements['PhimD' + i].value == iKey
          )
            // Clear conflict key
            ChamDiem.elements['PhimD' + i].value = '';
        }

        // Clear conflict for control keys
        for (i = 1; i <= 11; i++)
          if (
            oCtrl.name != aCtrl[i] &&
            ChamDiem.elements[aCtrl[i]].value == iKey
          )
            ChamDiem.elements[aCtrl[i]].value = '';

        oCtrl.value = iKey;
        // Show string to assist saving default.
        ChamDiem.aDefKeys.value = 'Array(';

        for (i = 1; i <= 4; i++) {
          ChamDiem.aDefKeys.value +=
            ChamDiem.elements['PhimX' + i].value + ', ';
          ChamDiem.aDefKeys.value +=
            ChamDiem.elements['PhimX' + (i + 4)].value + ', ';
          ChamDiem.aDefKeys.value +=
            ChamDiem.elements['PhimX' + (i + 8)].value + ', ';
          ChamDiem.aDefKeys.value +=
            ChamDiem.elements['PhimD' + i].value + ', ';
          ChamDiem.aDefKeys.value +=
            ChamDiem.elements['PhimD' + (i + 4)].value + ', ';
          ChamDiem.aDefKeys.value +=
            ChamDiem.elements['PhimD' + (i + 8)].value + ', ';
        }

        // Add control keys
        for (i = 1; i <= 11; i++)
          ChamDiem.aDefKeys.value +=
            ChamDiem.elements[aCtrl[i]].value + (i != 11 ? ', ' : ');');

        // Move focus to next control key
        for (i = 0; i <= 11 && oCtrl.name != aCtrl[i]; i++);
        if (i < 11) {
          ChamDiem.elements[aCtrl[i + 1]].focus();
        } else if (i == 11) {
          oCtrl.blur();
          showHide('key-configuration-area');
        } else {
          var sChar = oCtrl.name.substr(4, 1);
          var iNum = Number(oCtrl.name.substr(5, 2));
          ChamDiem.elements[
            'Phim' +
              (iNum <= 8 ? sChar : sChar == 'X' ? 'D' : 'X') +
              (iNum <= 8 ? iNum + 4 : sChar == 'X' ? iNum - 8 : iNum - 8 + 1)
          ].focus();
        }
      }

      function setMatch(iNum, sVDV) {
        // iNum: 1 đến 12, số thứ tự phím chấm điểm
        // sVDV: X hay D
        var iThayDoi = 0;
        var iNhom = Math.floor((iNum - 1) / 4);
        var iLan = 1;
        var iThay = -1;
        var i;
        var sTemp;
        const isVdvBlue = sVDV == 'X';

        // Tìm xem nhóm đã có chưa
        for (
          i = iDau;
          iThay < 0 && i != (iCuoi + 1) % iToiDa;
          i = (i + 1) % iToiDa
        ) {
          // Bug: iCuoi < iDau thi bi treo
          // Neu phim do da co thi qua nhom tiep theo
          if (
            sVDV == aMVDV[i] &&
            aMKey[i].indexOf((iNum < 10 ? '0' : '') + iNum) > -1
          ) {
          } else if (
            sVDV == aMVDV[i] &&
            aMGroup[i] == iNhom // Phím chưa có và trùng nhóm, tìm thấy nhóm khớp
          )
            iThay = i;
        }

        if (aMStatus[iThay] == 1) {
          // Tìm thấy nhóm mà không trùng phím
          aMCount[iThay]++; // Tang so dem
          aMKey[iThay] += (iNum < 10 ? '0' : '') + iNum + ','; // Ghi nhận lại phím, dấu phẩy để tránh trường hợp tìm thấy 10 trong 0103

          const twoInThreeChecked =
            document.getElementById('HaiTrongBa').checked;

          // Nếu số đếm = 2 thì tăng điểm
          if (
            (aMCount[iThay] == 3 && !twoInThreeChecked) ||
            (aMCount[iThay] == 2 && twoInThreeChecked)
          ) {
            const isNhom0 = iNhom == 0; // 3 point
            const isNhom1 = iNhom == 1; // 1 point
            const point = isNhom0 ? 3 : isNhom1 ? 1 : 2;

            if (isVdvBlue) {
              ChamDiem.DiemX.value = Number(ChamDiem.DiemX.value) + point;
            } else {
              ChamDiem.DiemD.value = Number(ChamDiem.DiemD.value) + point;
            }

            // Increase statistic score by point
            changeStatisticScore({
              isVdvBlue,
              point,
              isIncrease: true,
            });
          }
        } else {
          // Nhom moi hay lan moi
          iCuoi = (iCuoi + 1) % iToiDa;
          aMt[iCuoi] = setTimeout(
            'clearMatch(' + iCuoi + ');',
            ChamDiem.TGKhopPhim.value
          );

          aMGroup[iCuoi] = iNhom;
          aMVDV[iCuoi] = sVDV;
          aMKey[iCuoi] = (iNum < 10 ? '0' : '') + iNum + ',';
          aMCount[iCuoi] = 1;
          aMStatus[iCuoi] = 1;
        }

        // Hien cac o cho biet loai phim bam
        if (isVdvBlue) {
          aXHien[iNum - 1]++;
          sTemp = 'X' + aNhom[iNhom].charAt(0) + (((iNum - 1) % 4) + 1);
          oDisplay.document.getElementById(sTemp).src =
            './img/' + aNhom[iNhom] + 'Dot.gif';
          if (oDisplay2)
            oDisplay2.document.getElementById(sTemp).src =
              './img/' + aNhom[iNhom] + 'Dot.gif';
        } else if (sVDV == 'D') {
          aDHien[iNum - 1]++;
          sTemp = 'D' + aNhom[iNhom].charAt(0) + (((iNum - 1) % 4) + 1);
          oDisplay.document.getElementById(sTemp).src =
            './img/' + aNhom[iNhom] + 'Dot.gif';
          if (oDisplay2)
            oDisplay2.document.getElementById(sTemp).src =
              './img/' + aNhom[iNhom] + 'Dot.gif';
        }
        showScore();
      }

      function changeStatisticScore({
        isVdvBlue = true,
        point,
        isIncrease = true,
      }) {
        const num = isIncrease ? 1 : -1;

        // Calculate gloves score value
        const glovesScoreBlueValue =
          Number(glovesScoreBlue.innerHTML) + num < 0
            ? 0
            : Number(glovesScoreBlue.innerHTML) + num;
        const glovesScoreRedValue =
          Number(glovesScoreRed.innerHTML) + num < 0
            ? 0
            : Number(glovesScoreRed.innerHTML) + num;

        // Calculate body score value
        const bodyScoreBlueValue =
          Number(bodyScoreBlue.innerHTML) + num < 0
            ? 0
            : Number(bodyScoreBlue.innerHTML) + num;
        const bodyScoreRedValue =
          Number(bodyScoreRed.innerHTML) + num < 0
            ? 0
            : Number(bodyScoreRed.innerHTML) + num;

        // Calculate head score value
        const headScoreBlueValue =
          Number(headScoreBlue.innerHTML) + num < 0
            ? 0
            : Number(headScoreBlue.innerHTML) + num;
        const headScoreRedValue =
          Number(headScoreRed.innerHTML) + num < 0
            ? 0
            : Number(headScoreRed.innerHTML) + num;

        switch (point) {
          case 1:
            if (isVdvBlue) {
              glovesScoreBlue.innerHTML = glovesScoreBlueValue;
            } else {
              glovesScoreRed.innerHTML = glovesScoreRedValue;
            }
            break;
          case 2:
            if (isVdvBlue) {
              bodyScoreBlue.innerHTML = bodyScoreBlueValue;
            } else {
              bodyScoreRed.innerHTML = bodyScoreRedValue;
            }
            break;
          case 3:
            if (isVdvBlue) {
              headScoreBlue.innerHTML = headScoreBlueValue;
            } else {
              headScoreRed.innerHTML = headScoreRedValue;
            }
            break;

          default:
            break;
        }
      }

      function calculateStatisticScore(sVDV, iDiem, pointCount) {
        const isVdvX = sVDV == 'X';
        const isIncrease = iDiem === 1; // 1 or -1

        const bodyScoreBlueCurrentValue = Number(bodyScoreBlue.innerHTML);
        const bodyScoreRedCurrentValue = Number(bodyScoreRed.innerHTML);

        const headScoreBlueCurrentValue = Number(headScoreBlue.innerHTML);
        const headScoreRedCurrentValue = Number(headScoreRed.innerHTML);

        switch (pointCount) {
          case 1:
            changeStatisticScore({
              isVdvBlue: sVDV == 'X',
              point: 1,
              isIncrease,
            });
            break;

          case 2:
            changeStatisticScore({
              isVdvBlue: sVDV == 'X',
              point: 2,
              isIncrease,
            });

            // Recursion to deduct points appropriately
            if (!isIncrease && isVdvX && bodyScoreBlueCurrentValue <= 0) {
              calculateStatisticScore(sVDV, iDiem, 1);
              calculateStatisticScore(sVDV, iDiem, 1);
            }

            if (!isIncrease && !isVdvX && bodyScoreRedCurrentValue <= 0) {
              calculateStatisticScore(sVDV, iDiem, 1);
              calculateStatisticScore(sVDV, iDiem, 1);
            }
            break;

          case 3:
            changeStatisticScore({
              isVdvBlue: sVDV == 'X',
              point: 3,
              isIncrease,
            });

            // Recursion to deduct points appropriately
            if (!isIncrease && isVdvX && headScoreBlueCurrentValue <= 0) {
              calculateStatisticScore(sVDV, iDiem, 2);
              calculateStatisticScore(sVDV, iDiem, 1);
            }

            if (!isIncrease && !isVdvX && headScoreRedCurrentValue <= 0) {
              calculateStatisticScore(sVDV, iDiem, 2);
              calculateStatisticScore(sVDV, iDiem, 1);
            }
            break;

          default:
            break;
        }
      }

      function modifyStatisticScore(sVDV, iDiem) {
        const MATCHED_KEY_TIME = 1200;
        let pointRemaining = 0;

        pointCount++;
        clearTimeout(pointTimer);

        pointTimer = setTimeout(function () {
          calculateStatisticScore(sVDV, iDiem, pointCount);

          clearTimeout(pointTimer);
          pointCount = 0;
        }, MATCHED_KEY_TIME);
      }

      function clearMatch(iNhom) {
        var sTemp;
        aMStatus[iNhom] = 2;

        for (var i = 1; i <= 12; i++) {
          // Giam lan hien dau hieu phim bam
          if (aMKey[iNhom].indexOf((i < 10 ? '0' : '') + i) > -1) {
            // Neu co phim thi giam so lan bam
            var sImg = '';
            if (aMVDV[iNhom] == 'X') {
              aXHien[i - 1]--;
              if (aXHien[i - 1] == 0) sImg = 'xanh'; // Dau hieu da het lan bam
            } else if (aMVDV[iNhom] == 'D') {
              aDHien[i - 1]--;
              if (aDHien[i - 1] == 0) sImg = 'do'; // Dau hieu da het lan bam
            }

            // Xoa cac dau hieu
            if (sImg != '') {
              sTemp =
                aMVDV[iNhom] +
                aNhom[aMGroup[iNhom]].charAt(0) +
                (((i - 1) % 4) + 1);
              oDisplay.document.getElementById(sTemp).src =
                './img/' + sImg + 'Dot.gif';
              if (oDisplay2)
                oDisplay2.document.getElementById(sTemp).src =
                  './img/' + sImg + 'Dot.gif';
            }
          }
        }

        aMGroup[iNhom] = -1;
        aMVDV[iNhom] = '';
        aMKey[iNhom] = '';
        aMCount[iNhom] = 0;
        aMStatus[iNhom] = 0;
        iDau = (iDau + 1) % iToiDa;
      }

      function decrease(sVDV, bCancel) {
        if (
          (ChamDiem.TruX.value < I_MAX_LOI &&
            ChamDiem.TruD.value < I_MAX_LOI) ||
          bCancel
        ) {
          if (sVDV == 'X') {
            if (!bCancel) {
              ChamDiem.TruX.value++;
              if (ChamDiem.TruX.value % 1 == 0) ChamDiem.DiemD.value++;
            } else if (ChamDiem.TruX.value > 0) {
              ChamDiem.TruX.value--;
              if (ChamDiem.TruX.value % 1 == 0 && ChamDiem.DiemD.value > 0)
                ChamDiem.DiemD.value--;
            }
          } else {
            if (!bCancel) {
              ChamDiem.TruD.value++;
              if (ChamDiem.TruD.value % 1 == 0) ChamDiem.DiemX.value++;
            } else if (ChamDiem.TruD.value > 0) {
              ChamDiem.TruD.value--;
              if (ChamDiem.TruD.value % 1 == 0 && ChamDiem.DiemX.value > 0)
                ChamDiem.DiemX.value--;
            }
          }
        }

        showScore();

        if (
          ChamDiem.TruX.value >= I_MAX_LOI ||
          ChamDiem.TruD.value >= I_MAX_LOI
        )
          doneFight();
      }

      function modify(sVDV, iDiem) {
        const isScore1 = iDiem == 1;
        const isScore2 = iDiem == -2;
        const score = isScore2 ? -1 : iDiem;

        const scoreBlueValue = Number(ChamDiem.DiemX.value);
        const scoreRedValue = Number(ChamDiem.DiemD.value);

        if (sVDV == 'X') {
          if (isScore1 || isScore2 || scoreBlueValue + iDiem >= 0)
            ChamDiem.DiemX.value = scoreBlueValue + score;
        } else {
          if (isScore1 || isScore2 || scoreRedValue + iDiem >= 0)
            ChamDiem.DiemD.value = scoreRedValue + score;
        }

        if (
          isScore1 ||
          scoreBlueValue + iDiem >= 0 ||
          scoreRedValue + iDiem >= 0
        ) {
          modifyStatisticScore(sVDV, iDiem);
        }

        // Delete all score due to conflict
        if (scoreBlueValue + iDiem <= 0) {
          const isOnlyRed = false;
          const isOnlyBlue = true;
          clearStatisticScore(isOnlyRed, isOnlyBlue);
        }

        if (scoreRedValue + iDiem <= 0) {
          const isOnlyRed = true;
          const isOnlyBlue = false;
          clearStatisticScore(isOnlyRed, isOnlyBlue);
        }
        // Delete all score due to conflict

        showScore();
      }

      function startFight() {
        if (ChamDiem.TruX.value < 8 && ChamDiem.TruD.value < 8) {
          iTimeLeft = ChamDiem.TGHiepDau.value;
          bTickOn = true;
          bIsFighting = true;
          bInBreak = false;
          resetPause();
          showTimeLeft();
          iRoundCount = 1;
          showRound(iRoundCount);
          t2 = setTimeout('inFight();', 500);
          document.getElementById('HaiManHinh').disabled = true;
          document.getElementById('HaiTrongBa').disabled = true;
          ChamDiem.BatDau.blur();
          ChamDiem.BatDau.disabled = true;
          document.getElementById('DungSS').disabled = false;
          document.getElementById('DungXX').disabled = false;
          ChamDiem.XoaDiem.disabled = true;
          ChamDiem.TGHiepDau.disabled = true;
          ChamDiem.TGNghiGiuaHiep.disabled = true;
          showScore();
        }
      }

      function restartFight() {
        iTimeLeft =
          60 * Number(ChamDiem.DatLaiPhut.value) +
          Number(ChamDiem.DatLaiGiay.value);
        bIsFighting = true;
        bTickOn = true;
        bInBreak = false;
        resetPause();
        showTimeLeft();
        iRoundCount = Number(ChamDiem.DatLaiHiep.value);
        showInfo('HangCan');
        showInfo('GioiTinh');
        showRound(iRoundCount);
        // Bo bo dem gio cu truoc khi dat bo dem gio moi
        clearTimeout(t2);
        t2 = setTimeout('inFight();', 500);
        document.getElementById('HaiManHinh').disabled = true;
        document.getElementById('HaiTrongBa').disabled = true;
        ChamDiem.BatDau.disabled = true;
        document.getElementById('DungSS').disabled = false;
        document.getElementById('DungXX').disabled = false;
        ChamDiem.XoaDiem.disabled = true;
        ChamDiem.TGHiepDau.disabled = true;
        ChamDiem.TGNghiGiuaHiep.disabled = true;
        showScore();
      }

      function inFight() {
        if (!bPause) {
          bTickOn = !bTickOn;
          if (bTickOn) iTimeLeft--;
          showTimeLeft();
        } else {
          bPauseTick = !bPauseTick;
          if (bPauseTick) {
            if (bPauseType == 'xx') iPauseTime++; // Count up for XemXet pause
            else iPauseTime--; // Count down for SanSoc pause
          }
          showPauseTime();
          if (bPauseType == 'ss' && iPauseTime == 0) {
            // Time limit is reached, stop fighting
            doneFight();
          }
        }

        if (iTimeLeft == 0 || iRoundCount == 4) {
          // Nghi giua hiep hay het tran dau
          if (
            (iRoundCount == 3 &&
              Number(ChamDiem.DiemD.value) != Number(ChamDiem.DiemX.value)) ||
            (iRoundCount == 4 &&
              (iTimeLeft == 0 ||
                Number(ChamDiem.DiemD.value) != Number(ChamDiem.DiemX.value)))
          ) {
            // Het tran dau neu diem khong bang nhau o cuoi hiep 3, hay khi het hiep 4
            doneFight();
          } else if (iTimeLeft == 0) {
            // Het hiep hay het gio nghi
            if (!bInBreak) {
              // Het hiep
              iTimeLeft = ChamDiem.TGNghiGiuaHiep.value;
              bTickOn = true;
              bInBreak = true;
              document.getElementById('DungSS').disabled = true;
              document.getElementById('DungXX').disabled = true;
              document.getElementById('GioiTinh').innerHTML = 'GIỮA HIỆP';
              duplicateDisplay('GioiTinh');
            } else {
              // Het gio nghi
              iRoundCount++;
              showRound(iRoundCount);
              iTimeLeft = ChamDiem.TGHiepDau.value;
              bTickOn = true;
              bInBreak = false;
              document.getElementById('DungSS').disabled = false;
              document.getElementById('DungXX').disabled = false;
              showInfo('GioiTinh');
            }
          }
        }

        if (iTimeLeft > 0 && bIsFighting) t2 = setTimeout('inFight();', 500);

        if (
          iTimeLeft > 2 &&
          iTimeLeft <= 11 &&
          iTimeLeft % 2 == 1 &&
          !bTickOn
        ) {
          document.getElementById('wavCountDown').play();
        }

        if (iTimeLeft == 1 && bTickOn)
          document
            .getElementById(bInBreak ? 'wavDoneBreak' : 'wavDoneFight')
            .play();
      }

      function doneFight() {
        bIsFighting = false;
        bPause = false;
        bInBreak = false;
        ChamDiem.BatDau.disabled = false;
        document.getElementById('HaiManHinh').disabled = false;
        document.getElementById('HaiTrongBa').disabled = false;
        document.getElementById('DungSS').disabled = true;
        document.getElementById('DungXX').disabled = true;
        ChamDiem.XoaDiem.disabled = false;
        ChamDiem.TGHiepDau.disabled = false;
        ChamDiem.TGNghiGiuaHiep.disabled = false;

        if (Number(ChamDiem.DiemD.value) > Number(ChamDiem.DiemX.value)) {
          blinkScore('DiemDo', true);
        }

        if (Number(ChamDiem.DiemD.value) < Number(ChamDiem.DiemX.value)) {
          blinkScore('DiemXanh', true);
        }
      }

      function newTimeLeft() {
        iTimeLeft = ChamDiem.TGHiepDau.value;
        bTickOn = true;
        showTimeLeft();
      }

      function showTimeLeft() {
        const oObj = oDisplay.document.getElementById('GioConLai');
        let sSec = iTimeLeft % 60;
        let sMin = (iTimeLeft - sSec) / 60;
        sMin = (sMin < 10 ? '0' : '') + String(sMin);
        sSec = (sSec < 10 ? '0' : '') + String(sSec);

        oObj.innerHTML =
          sMin + (bTickOn ? ':' : '<font color="#000000">:</font>') + sSec;
        duplicateDisplay('GioConLai');
      }

      function showPauseTime() {
        const oObj = oDisplay.document.getElementById('HangCan');
        let sSec = iPauseTime % 60;
        let sMin = (iPauseTime - sSec) / 60;

        sMin = (sMin < 10 ? '0' : '') + String(sMin);
        sSec = (sSec < 10 ? '0' : '') + String(sSec);
        oObj.innerHTML =
          sMin + (bPauseTick ? ':' : '<font color="#000000">:</font>') + sSec;
        duplicateDisplay('HangCan');
      }

      function showScore() {
        const sDiemX = ChamDiem.DiemX.value;
        const sDiemD = ChamDiem.DiemD.value;
        const iTruX = Number(ChamDiem.TruX.value);
        const iTruD = Number(ChamDiem.TruD.value);

        if (bIsFighting) {
          let sInfo = 'At ' + iTimeLeft + ' tick ' + (bTickOn ? 'on' : 'off');
          sInfo += ': X(' + sDiemX + '-' + iTruX;
          sInfo += ', M=' + sMatchX1 + ', B=' + sMatchX2 + ', K=' + sMatchX3;
          sInfo += ') D(' + sDiemD + '-' + iTruD;
          sInfo +=
            ', M=' +
            sMatchD1 +
            ', B=' +
            sMatchD2 +
            ', K=' +
            sMatchD3 +
            ')' +
            String.fromCharCode(13, 10);
        }

        oDisplay.document.getElementById('DiemXanh').innerHTML = sDiemX;
        if (oDisplay2)
          oDisplay2.document.getElementById('DiemXanh').innerHTML = sDiemX;
        oDisplay.document.getElementById('DiemDo').innerHTML = sDiemD;
        if (oDisplay2)
          oDisplay2.document.getElementById('DiemDo').innerHTML = sDiemD;

        for (var i = 1; i <= I_MAX_LOI; i++) {
          oDisplay.document.getElementById('Xtru' + i).src =
            './img/' +
            (i <= iTruX ? (i % 2 == 1 ? 'bLeftHlf' : 'bRightHlf') : 'xanhDot') +
            '.gif';

          if (oDisplay2)
            oDisplay2.document.getElementById('Xtru' + i).src =
              oDisplay.document.getElementById('Xtru' + i).src;
          oDisplay.document.getElementById('Dtru' + i).src =
            './img/' +
            (i <= iTruD ? (i % 2 == 1 ? 'rLeftHlf' : 'rRightHlf') : 'doDot') +
            '.gif';
          if (oDisplay2)
            oDisplay2.document.getElementById('Dtru' + i).src =
              oDisplay.document.getElementById('Dtru' + i).src;
        }
      }

      function blinkScore(sID, bBlinking) {
        const sDiem = document.getElementById(
          sID == 'DiemXanh' ? 'DiemX' : 'DiemD'
        ).value;

        oDisplay.document.getElementById(sID).innerHTML = bBlinking
          ? sDiem.blink()
          : sDiem;
        duplicateDisplay(sID);
      }

      function clearScore() {
        if (
          ChamDiem.DiemX.value +
            ChamDiem.DiemD.value +
            ChamDiem.TruX.value +
            ChamDiem.TruD.value ==
            0 ||
          confirm(
            'Có thật sự muốn xóa điểm không?\n- Bấm OK là có\n- Bấm Cancel là không'
          ) == true
        ) {
          ChamDiem.DiemX.value = 0;
          ChamDiem.DiemD.value = 0;
          ChamDiem.TruX.value = 0;
          ChamDiem.TruD.value = 0;

          const isOnlyRed = true;
          const isOnlyBlue = true;
          clearStatisticScore(isOnlyRed, isOnlyBlue);

          showScore();
        }
      }

      function clearStatisticScore(isOnlyRed = false, isOnlyBlue = false) {
        if (isOnlyRed) {
          headScoreRed.innerHTML = 0;
          bodyScoreRed.innerHTML = 0;
          glovesScoreRed.innerHTML = 0;
        }

        if (isOnlyBlue) {
          headScoreBlue.innerHTML = 0;
          bodyScoreBlue.innerHTML = 0;
          glovesScoreBlue.innerHTML = 0;
        }
      }

      function showList() {
        var oList = document.getElementById('ChonTran');
        for (; oList.length > 0; oList.remove(0));

        var aList = document
          .getElementById('DanhSachTran')
          .value.split(String.fromCharCode(10));

        for (var i = 0; i < aList.length; i++)
          if (aList[i] != '') {
            var y = document.createElement('option');
            y.text = aList[i].split(String.fromCharCode(9));
            y.value = i + 1;
            try {
              oList.add(y, null);
            } catch (ex) {
              oList.add(y);
            }
          }

        if (aList.length > 0) {
          oList.selectedIndex = 0;
        }

        showAllInfo();
      }

      function showAllInfo() {
        const oList = document.getElementById('ChonTran');

        if (oList.length > 0) {
          var aList = oList.options[oList.selectedIndex].text.split(',');

          if (aList.length < 4) {
            aList = oList.options[oList.selectedIndex].text.split(';');
          }

          if (aList.length >= 4) {
            var i = aList.length == 5 ? 1 : 0;
            ChamDiem.GioiTinh.value = aList[i];
            ChamDiem.HangCan.value = aList[i + 1];
            ChamDiem.TenDo.value = aList[i + 2];
            ChamDiem.TenXanh.value = aList[i + 3];
          }
        }

        showInfo('TenXanh');
        showInfo('TenDo');
        showInfo('GioiTinh');
        showInfo('HangCan');
        showInfo('TranSo');
        clearScore();
        newTimeLeft();
      }

      function showRound(iRound) {
        oDisplay.document.getElementById('HiepSo').innerHTML = iRound;

        if (oDisplay2) {
          oDisplay2.document.getElementById('HiepSo').innerHTML =
            oDisplay.document.getElementById('HiepSo').innerHTML;
        }
      }

      function showHide(sID, oFocusTo) {
        const oObj = oDisplay.document.getElementById(sID);
        oObj.style.display = oObj.style.display == 'none' ? 'block' : 'none';

        if (oDisplay2) {
          oDisplay2.document.getElementById(sID).display = oObj.style.display;
        }

        if (oFocusTo && oObj.style.display != 'none') {
          oFocusTo.focus();
        }
      }

      function showInfo(sID) {
        if (!oDisplay.document.getElementById(sID))
          alert('DIV named ' + sID + ' not found! Please add it.');
        else if (!ChamDiem.elements[sID])
          alert('INPUT TEXT named ' + sID + ' not found! Please add it.');
        else {
          oDisplay.document.getElementById(sID).innerHTML =
            ChamDiem.elements[sID].value != ''
              ? ChamDiem.elements[sID].value
              : '&nbsp;';
          if (oDisplay2) {
            oDisplay2.document.getElementById(sID).innerHTML =
              oDisplay.document.getElementById(sID).innerHTML;
          }
        }
      }

      function duplicateDisplay(sID) {
        if (oDisplay2) {
          oDisplay2.document.getElementById(sID).innerHTML =
            oDisplay.document.getElementById(sID).innerHTML;
        }
      }

      function showDisplayWindow() {
        if (document.getElementById('HaiManHinh').checked) {
          oDisplay2 = window.open(
            'HienThi.html',
            '_blank',
            'location=no;menubar=no;status=no;toolbar=no'
          );
          alert(
            'Tạm dừng để mở cửa sổ hiển thị. Vui lòng nhấn OK khi cửa sổ đã hiện ra xong.\nĐể hệ thống hoạt động đúng, của sổ chính phải luôn được chọn.'
          );
        } else {
          if (oDisplay2) oDisplay2.close();
        }
        showTimeLeft();
        showScore();
      }

      function loadDomElementStatistic() {
        headScoreRed = document.querySelector('.head-score-red');
        bodyScoreRed = document.querySelector('.body-score-red');
        glovesScoreRed = document.querySelector('.gloves-score-red');

        headScoreBlue = document.querySelector('.head-score-blue');
        bodyScoreBlue = document.querySelector('.body-score-blue');
        glovesScoreBlue = document.querySelector('.gloves-score-blue');
      }

      function onLoad() {
        for (i = 1; i <= 11; i++) {
          ChamDiem.elements[aCtrl[i]].value = aDefKeys[i + 24 - 1];
        }

        ChamDiem.PhimX1.value = aDefKeys[0];
        ChamDiem.PhimX5.value = aDefKeys[1];
        ChamDiem.PhimX9.value = aDefKeys[2];
        ChamDiem.PhimD1.value = aDefKeys[3];
        ChamDiem.PhimD5.value = aDefKeys[4];
        ChamDiem.PhimD9.value = aDefKeys[5];
        ChamDiem.PhimX2.value = aDefKeys[6];
        ChamDiem.PhimX6.value = aDefKeys[7];
        ChamDiem.PhimX10.value = aDefKeys[8];
        ChamDiem.PhimD2.value = aDefKeys[9];
        ChamDiem.PhimD6.value = aDefKeys[10];
        ChamDiem.PhimD10.value = aDefKeys[11];
        ChamDiem.PhimX3.value = aDefKeys[12];
        ChamDiem.PhimX7.value = aDefKeys[13];
        ChamDiem.PhimX11.value = aDefKeys[14];
        ChamDiem.PhimD3.value = aDefKeys[15];
        ChamDiem.PhimD7.value = aDefKeys[16];
        ChamDiem.PhimD11.value = aDefKeys[17];
        ChamDiem.PhimX4.value = aDefKeys[18];
        ChamDiem.PhimX8.value = aDefKeys[19];
        ChamDiem.PhimX12.value = aDefKeys[20];
        ChamDiem.PhimD4.value = aDefKeys[21];
        ChamDiem.PhimD8.value = aDefKeys[22];
        ChamDiem.PhimD12.value = aDefKeys[23];
        oDisplay = window;

        showDisplayWindow();
        loadDomElementStatistic();
        clearScore();
        showList();
      }

      function onUnload() {
        clearInterval(t2);
        doneFight();

        if (oDisplay2) oDisplay2.close();
      }
    </script>
  </head>
  <body
    onkeydown="onKeyDown(event, 'down')"
    onkeyup="onKeyDown(event, 'up')"
    onload="onLoad()"
    onunload="onUnload()"
  >
    <div id="Display">
      <table width="100%" border="0" cellpadding="0" cellspacing="0" border="1">
        <tr align="center" valign="top">
          <td colspan="2">
            <span id="TranSo" class="Hiep">1</span>
          </td>
          <td colspan="2">
            <span id="GioConLai" class="Hiep">&nbsp;</span>
          </td>
          <td colspan="2">
            <span id="HiepSo" class="Hiep">1</span>
          </td>
        </tr>

        <tr align="center" valign="top">
          <td width="10%" class="Do">
            <div class="umpire-list">
              <div class="umpire-item">
                <span>1</span
                ><img id="Dm1" src="./img/doDot.gif" class="MatBung" />
              </div>
              <div class="umpire-item">
                <span>2</span
                ><img id="Dm2" src="./img/doDot.gif" class="MatBung" />
              </div>
              <div class="umpire-item">
                <span>3</span
                ><img id="Dm3" src="./img/doDot.gif" class="MatBung" />
              </div>
              <div class="umpire-item umpire-item--end">
                <span>4</span
                ><img id="Dm4" src="./img/doDot.gif" class="MatBung" />
              </div>

              <div class="umpire-item">
                <span>1</span
                ><img id="Dk1" src="./img/doDot.gif" class="MatBung" />
              </div>
              <div class="umpire-item">
                <span>2</span
                ><img id="Dk2" src="./img/doDot.gif" class="MatBung" />
              </div>
              <div class="umpire-item">
                <span>3</span
                ><img id="Dk3" src="./img/doDot.gif" class="MatBung" />
              </div>
              <div class="umpire-item umpire-item--end">
                <span>4</span
                ><img id="Dk4" src="./img/doDot.gif" class="MatBung" />
              </div>

              <div class="umpire-item">
                <span>1</span
                ><img id="Db1" src="./img/doDot.gif" class="MatBung" />
              </div>
              <div class="umpire-item">
                <span>2</span
                ><img id="Db2" src="./img/doDot.gif" class="MatBung" />
              </div>
              <div class="umpire-item">
                <span>3</span
                ><img id="Db3" src="./img/doDot.gif" class="MatBung" />
              </div>
              <div class="umpire-item umpire-item--end">
                <span>4</span
                ><img id="Db4" src="./img/doDot.gif" class="MatBung" />
              </div>
            </div>
          </td>
          <td width="40%" class="Do" colspan="2">
            <div class="score-statistic-wrap">
              <div class="score">
                <span id="DiemDo" class="Diem">0</span><br/ >
                <img id="Dtru1" src="./img/doDot.gif" class="DiemTru" /><img
                  id="Dtru2"
                  src="./img/doDot.gif"
                  class="DiemTru"
                />
                &nbsp;
                <img id="Dtru3" src="./img/doDot.gif" class="DiemTru" /><img
                  id="Dtru4"
                  src="./img/doDot.gif"
                  class="DiemTru"
                />
                &nbsp;
                <img id="Dtru5" src="./img/doDot.gif" class="DiemTru" /><img
                  id="Dtru6"
                  src="./img/doDot.gif"
                  class="DiemTru"
                />
                &nbsp;
                <img id="Dtru7" src="./img/doDot.gif" class="DiemTru" /><img
                  id="Dtru8"
                  src="./img/doDot.gif"
                  class="DiemTru"
                />
                &nbsp;
                <img id="Dtru9" src="./img/doDot.gif" class="DiemTru" /><img
                  id="Dtru10"
                  src="./img/doDot.gif"
                  class="DiemTru"
                />
              </div>
              <div class="statistic">
                <div class="statistic-item head-guard">
                  <img
                    src="./img/head-guard.png"
                    alt="Head Guard"
                    class="statistic-icon head-guard-icon"
                  />
                  <span class="statistic-score head-score-red">0</span>
                </div>
                <div class="statistic-item body-guard">
                  <img
                    src="./img/body-guard.png"
                    alt="Body Guard"
                    class="statistic-icon body-guard-icon"
                  />
                  <span class="statistic-score body-score-red">0</span>
                </div>
                <div class="statistic-item gloves">
                  <img
                    src="./img/gloves.png"
                    alt="gloves"
                    class="statistic-icon gloves-icon"
                  />
                  <span class="statistic-score gloves-score-red">0</span>
                </div>
              </div>
            </div>
          </td>
          <td width="40%" class="Xanh" colspan="2">
            <div class="score-statistic-wrap">
              <div class="statistic">
                <div class="statistic-item head-guard">
                  <img
                    src="./img/head-guard.png"
                    alt="Head Guard"
                    class="statistic-icon head-guard-icon"
                  />
                  <span class="statistic-score head-score-blue">0</span>
                </div>
                <div class="statistic-item body-guard">
                  <img
                    src="./img/body-guard.png"
                    alt="Body Guard"
                    class="statistic-icon body-guard-icon"
                  />
                  <span class="statistic-score body-score-blue">0</span>
                </div>
                <div class="statistic-item gloves">
                  <img
                    src="./img/gloves.png"
                    alt="gloves"
                    class="statistic-icon gloves-icon"
                  />
                  <span class="statistic-score gloves-score-blue">0</span>
                </div>
              </div>
              <div class="score">
                <span id="DiemXanh" class="Diem">0</span><br/ >
                <img id="Xtru1" src="./img/xanhDot.gif" class="DiemTru" /><img
                  id="Xtru2"
                  src="./img/xanhDot.gif"
                  class="DiemTru"
                />
                &nbsp;
                <img id="Xtru3" src="./img/xanhDot.gif" class="DiemTru" /><img
                  id="Xtru4"
                  src="./img/xanhDot.gif"
                  class="DiemTru"
                />
                &nbsp;
                <img id="Xtru5" src="./img/xanhDot.gif" class="DiemTru" /><img
                  id="Xtru6"
                  src="./img/xanhDot.gif"
                  class="DiemTru"
                />
                &nbsp;
                <img id="Xtru7" src="./img/xanhDot.gif" class="DiemTru" /><img
                  id="Xtru8"
                  src="./img/xanhDot.gif"
                  class="DiemTru"
                />
                &nbsp;
                <img id="Xtru9" src="./img/xanhDot.gif" class="DiemTru" /><img
                  id="Xtru10"
                  src="./img/xanhDot.gif"
                  class="DiemTru"
                />
              </div>
            </div>
          </td>
          <td width="10%" class="Xanh">
            <div class="umpire-list">
              <div class="umpire-item">
                <img id="Xm1" src="./img/xanhDot.gif" class="MatBung" />
                <span>1</span>
              </div>
              <div class="umpire-item">
                <img id="Xm2" src="./img/xanhDot.gif" class="MatBung" />
                <span>2</span>
              </div>
              <div class="umpire-item">
                <img id="Xm3" src="./img/xanhDot.gif" class="MatBung" />
                <span>3</span>
              </div>
              <div class="umpire-item umpire-item--end">
                <img id="Xm4" src="./img/xanhDot.gif" class="MatBung" />
                <span>4</span>
              </div>

              <div class="umpire-item">
                <img id="Xk1" src="./img/xanhDot.gif" class="MatBung" />
                <span>1</span>
              </div>
              <div class="umpire-item">
                <img id="Xk2" src="./img/xanhDot.gif" class="MatBung" />
                <span>2</span>
              </div>
              <div class="umpire-item">
                <img id="Xk3" src="./img/xanhDot.gif" class="MatBung" />
                <span>3</span>
              </div>
              <div class="umpire-item umpire-item--end">
                <img id="Xk4" src="./img/xanhDot.gif" class="MatBung" />
                <span>4</span>
              </div>

              <div class="umpire-item">
                <img id="Xb1" src="./img/xanhDot.gif" class="MatBung" />
                <span>1</span>
              </div>
              <div class="umpire-item">
                <img id="Xb2" src="./img/xanhDot.gif" class="MatBung" />
                <span>2</span>
              </div>
              <div class="umpire-item">
                <img id="Xb3" src="./img/xanhDot.gif" class="MatBung" />
                <span>3</span>
              </div>
              <div class="umpire-item umpire-item--end">
                <img id="Xb4" src="./img/xanhDot.gif" class="MatBung" />
                <span>4</span>
              </div>
            </div>
          </td>
        </tr>

        <tr align="center" valign="top">
          <td class="Do" colspan="2" width="30%">
            <span id="TenDo" class="Ten">VDV ĐỎ</span>
          </td>
          <td width="20%">
            <span id="GioiTinh" class="Ten">Giới tính</span>
          </td>
          <td width="20%">
            <span id="HangCan" class="Ten">Hạng cân</span>
          </td>
          <td class="Xanh" colspan="2" width="30%">
            <span id="TenXanh" class="Ten">VDV XANH</span>
          </td>
        </tr>

        <tr>
          <td width="10%"></td>
          <td width="20%"></td>
          <td width="20%"></td>
          <td width="20%"></td>
          <td width="20%"></td>
          <td width="10%"></td>
        </tr>
      </table>
    </div>

    <form
      id="ChamDiem"
      name="ChamDiem"
      class="mark-form"
      method="post"
      action="#"
    >
      <!-- MATCH CONFIGURATION TABLE -->
      <table border="2">
        <tr>
          <td></td>
          <td>
            Trận:
            <select
              name="TranSo"
              id="ChonTran"
              width="60"
              onchange="showAllInfo()"
            ></select
            ><br />
            Giới tính:
            <input
              type="text"
              name="GioiTinh"
              size="6"
              onchange="showInfo('GioiTinh')"
            /><br />
            Hạng cân:
            <input
              type="text"
              name="HangCan"
              size="6"
              onchange="showInfo('HangCan')"
            />
          </td>
          <td>
            <input
              type="checkbox"
              name="HaiManHinh"
              id="HaiManHinh"
              checked
              disabled
              onclick="showDisplayWindow()"
            />
            Dùng hai màn hình<br />
            <input
              type="button"
              class="BigButton"
              name="BatDau"
              id="BatDau"
              value="Bắt đầu"
              onclick="startFight()"
            /><br /><br />
            <input
              type="button"
              class="BigButton"
              name="KetThuc"
              id="KetThuc"
              value="Kết thúc"
              onclick="doneFight()"
            />
          </td>
          <td valign="bottom">
            <input
              id="HaiTrongBa"
              type="checkbox"
              name="HaiTrongBa"
              checked="true"
            />
            2 trong 3 trọng tài<br />
            <input
              type="button"
              class="BigButton"
              name="DungSS"
              id="DungSS"
              value="Dừng săn sóc / Tiếp tục"
              onclick="bPause = !bPause;setPause('ss')"
              disabled
            /><br /><br />
            <input
              type="button"
              class="BigButton"
              name="DungXX"
              id="DungXX"
              value="Dừng xem xét / Tiếp tục"
              onclick="bPause = !bPause;setPause('xx')"
              disabled
            />
          </td>
          <td></td>
          <td>
            Đặt lại hiệp
            <select id="DatLaiHiep" name="DatLaiHiep" width="30">
              <option>1</option>
              <option>2</option>
              <option>3</option>
              <option>4</option>
            </select>
            phút
            <select id="DatLaiPhut" name="DatLaiPhut" width="30">
              <option>0</option>
              <option>1</option>
              <option>2</option>
              <option>3</option>
            </select>
            giây
            <select id="DatLaiGiay" name="DatLaiGiay" width="30">
              <option>00</option>
              <option>01</option>
              <option>02</option>
              <option>03</option>
              <option>04</option>
              <option>05</option>
              <option>06</option>
              <option>07</option>
              <option>08</option>
              <option>09</option>
              <option>10</option>
              <option>11</option>
              <option>12</option>
              <option>13</option>
              <option>14</option>
              <option>15</option>
              <option>16</option>
              <option>17</option>
              <option>18</option>
              <option>19</option>
              <option>20</option>
              <option>21</option>
              <option>22</option>
              <option>23</option>
              <option>24</option>
              <option>25</option>
              <option>26</option>
              <option>27</option>
              <option>28</option>
              <option>29</option>
              <option>30</option>
              <option>31</option>
              <option>32</option>
              <option>33</option>
              <option>34</option>
              <option>35</option>
              <option>36</option>
              <option>37</option>
              <option>38</option>
              <option>39</option>
              <option>40</option>
              <option>41</option>
              <option>42</option>
              <option>43</option>
              <option>44</option>
              <option>45</option>
              <option>46</option>
              <option>47</option>
              <option>48</option>
              <option>49</option>
              <option>50</option>
              <option>51</option>
              <option>52</option>
              <option>53</option>
              <option>54</option>
              <option>55</option>
              <option>56</option>
              <option>57</option>
              <option>58</option>
              <option>59</option>
            </select>
            <buton
              type="button"
              class="start-again-btn"
              onclick="restartFight()"
              >Bắt đầu lại</buton
            >
          </td>
        </tr>
        <tr>
          <td></td>
          <th>Tên</th>
          <th>Điểm</th>
          <th>Lỗi</th>
          <th></th>
          <th>Thời gian</th>
        </tr>
        <tr>
          <th><span class="Xanh">Xanh</span></th>
          <td>
            <input
              type="text"
              name="TenXanh"
              class="Xanh"
              onchange="showInfo('TenXanh')"
            />
          </td>

          <td>
            <input
              type="text"
              name="DiemX"
              id="DiemX"
              class="Xanh"
              size="5"
              value="0"
              onfocus="onFocus(this)"
              onchange="showScore()"
            />
            <input
              type="button"
              name="CongDiemX"
              id="CongDiemX"
              value="+"
              onclick="modify('X', 1)"
            />
            <input
              type="button"
              name="TruDiemX"
              id="TruDiemX"
              value="-"
              onclick="modify('X', -1)"
            />&nbsp;&nbsp;&nbsp;
            <input
              type="button"
              name="TruDiemX"
              id="TruDiemX"
              value="--"
              onclick="modify('X', -2)"
            />
          </td>

          <td>
            <input
              type="text"
              name="TruX"
              class="Xanh"
              size="5"
              value="0"
              onfocus="onFocus(this)"
              onchange="showScore()"
            />
            <input
              type="button"
              name="CongLoiX"
              id="CongLoiX"
              value="+"
              onclick="decrease('X', false)"
            />
            <input
              type="button"
              name="TruLoiX"
              id="TruLoiX"
              value="-"
              onclick="decrease('X', true)"
            />
          </td>

          <td rowspan="2">
            <input
              type="button"
              name="XoaDiem"
              value="Xóa điểm"
              onclick="clearScore()"
            />
          </td>

          <td>
            <span>Một hiệp:</span>
            <select name="TGHiepDau" onfocus="onFocus(this)">
              <option value="15">Thử 15 giây</option>
              <option value="45">45 giây</option>
              <option value="60">1 phút</option>
              <option value="90" selected="selected">1 phút 30 giây</option>
              <option value="105">1 phút 45 giây</option>
              <option value="120">2 phút</option>
              <option value="150">2 phút 30 giây</option>
              <option value="180">3 phút</option>
              <option value="210">3 phút 30 giây</option>
              <option value="240">4 phút</option>
            </select>

            &nbsp;<span>TG Khớp phím:</span>
            <select name="TGKhopPhim" onfocus="onFocus(this)">
              <option value="500" selected="selected">0.5 giây</option>
              <option value="750">0.75 giây</option>
              <option value="1000">1.0 giây</option>
              <option value="1500">1.5 giây</option>
              <option value="2000">2.0 giây</option>
            </select>
          </td>
        </tr>
        <tr>
          <th><span class="Do">Đỏ</span></th>
          <td>
            <input
              type="text"
              name="TenDo"
              class="Do"
              onchange="showInfo('TenDo')"
            />
          </td>

          <td>
            <input
              type="text"
              name="DiemD"
              id="DiemD"
              class="Do"
              size="5"
              value="0"
              onfocus="onFocus(this)"
              onchange="showScore()"
            />
            <input
              type="button"
              name="CongDiemD"
              id="CongDiemD"
              value="+"
              onclick="modify('D', 1)"
            />
            <input
              type="button"
              name="TruDiemD"
              id="TruDiemD"
              value="-"
              onclick="modify('D', -1)"
            />&nbsp;&nbsp;&nbsp;
            <input
              type="button"
              name="TruDiemD"
              id="TruDiemD"
              value="--"
              onclick="modify('D', -2)"
            />
          </td>

          <td>
            <input
              type="text"
              name="TruD"
              class="Do"
              size="5"
              value="0"
              onfocus="onFocus(this)"
              onchange="showScore()"
            />
            <input
              type="button"
              name="CongLoiD"
              id="CongLoiD"
              value="+"
              onclick="decrease('D', false)"
            />
            <input
              type="button"
              name="TruLoiD"
              id="TruLoiD"
              value="-"
              onclick="decrease('D', true)"
            />
          </td>

          <td>
            Nghỉ giữa hiệp:
            <select name="TGNghiGiuaHiep" onfocus="onFocus(this)">
              <!--option value="20">1/3 phút</option-->
              <option value="15">Thử 15 giây</option>
              <option value="30" selected="selected">30 giây</option>
              <option value="45">45 giây</option>
              <option value="60">1 phút</option>
              <option value="90">1 phút 30 giây</option>
            </select>
          </td>
        </tr>
        <tr>
          <td colspan="7">
            <strong>Các trận đấu</strong>
            <br />
            STT;Giới tính;Hạng cân;Tên đỏ;Tên xanh<br />
            <textarea
              name="DanhSachTran"
              id="DanhSachTran"
              cols="78"
              rows="20"
              onchange="showList()"
              onfocus="onFocus(this)"
            ></textarea>
            <br />
          </td>
        </tr>
      </table>
      <!-- MATCH CONFIGURATION TABLE -->

      <!-- PLAY AUDIO SYSTEM -->
      <audio id="wavCountDown" controls style="display: hidden">
        <source src="file://C:/Windows/Media/chord.wav" type="audio/wav" />
        Your browser does not support the audio element.
      </audio>
      <audio id="wavDoneFight" controls style="display: hidden">
        <source src="file://C:/Windows/Media/tada.wav" type="audio/wav" />
        Your browser does not support the audio element.
      </audio>
      <audio id="wavDoneBreak" controls style="display: hidden">
        <source src="file://C:/Windows/Media/notify.wav" type="audio/wav" />
        Your browser does not support the audio element.
      </audio>
      <!-- PLAY AUDIO SYSTEM -->

      <!-- KEY CONFIGURATION -->
      <div id="key-configuration-area" style="display: none">
        <table summary="" border="1">
          <tr>
            <th></th>
            <th colspan="3"><div class="Xanh">Xanh</div></th>
            <th></th>
            <th colspan="3"><div class="Do">Đỏ</div></th>
            <th colspan="2">Điều khiển</th>
          </tr>
          <tr>
            <th></th>
            <th><div class="Xanh">Mặt</div></th>
            <th><div class="Xanh">Bụng</div></th>
            <th><div class="Xanh">Khó</div></th>
            <th></th>
            <th><div class="Do">Mặt</div></th>
            <th><div class="Do">Bụng</div></th>
            <th><div class="Do">Khó</div></th>
            <td rowspan="2">
              Bắt đầu / Tiếp tục<br />
              Dừng săn sóc<br />
              Dừng xem xét
            </td>
            <td rowspan="2">
              <input
                type="text"
                name="PhimBatDau"
                onfocus="onFocus(this)"
                size="5"
              /><br />
              <input
                type="text"
                name="PhimDungSS"
                onfocus="onFocus(this)"
                size="5"
              /><br />
              <input
                type="text"
                name="PhimDungXX"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
          </tr>
          <tr>
            <td>Trọng tài 1</td>
            <td>
              <input
                type="text"
                name="PhimX1"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimX5"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimX9"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>Trọng tài 1</td>
            <td>
              <input
                type="text"
                name="PhimD1"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimD5"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimD9"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
          </tr>
          <tr>
            <td>Trọng tài 2</td>
            <td>
              <input
                type="text"
                name="PhimX2"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimX6"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimX10"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>Trọng tài 2</td>
            <td>
              <input
                type="text"
                name="PhimD2"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimD6"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimD10"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td colspan="2" rowspan="5" valign="bottom">
              <textarea
                name="aDefKeys"
                cols="20"
                rows="7"
                onfocus="onFocus(this)"
              ></textarea>
            </td>
          </tr>
          <tr>
            <td>Trọng tài 3</td>
            <td>
              <input
                type="text"
                name="PhimX3"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimX7"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimX11"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>Trọng tài 3</td>
            <td>
              <input
                type="text"
                name="PhimD3"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimD7"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimD11"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
          </tr>
          <tr>
            <td>Trọng tài 4</td>
            <td>
              <input
                type="text"
                name="PhimX4"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimX8"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimX12"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>Trọng tài 4</td>
            <td>
              <input
                type="text"
                name="PhimD4"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimD8"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>
              <input
                type="text"
                name="PhimD12"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
          </tr>
          <tr>
            <td>Phạm lỗi</td>
            <td>
              <input
                type="text"
                name="PhimXTru"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>Hủy lỗi</td>
            <td>
              <input
                type="text"
                name="PhimXCong"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>Phạm lỗi</td>
            <td>
              <input
                type="text"
                name="PhimDTru"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>Hủy lỗi</td>
            <td>
              <input
                type="text"
                name="PhimDCong"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
          </tr>
          <tr>
            <td>Cộng điểm</td>
            <td>
              <input
                type="text"
                name="PhimXTruDiem"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>Trừ điểm</td>
            <td>
              <input
                type="text"
                name="PhimXCongDiem"
                class="Xanh"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>Cộng điểm</td>
            <td>
              <input
                type="text"
                name="PhimDTruDiem"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
            <td>Trừ điểm</td>
            <td>
              <input
                type="text"
                name="PhimDCongDiem"
                class="Do"
                onfocus="onFocus(this)"
                size="5"
              />
            </td>
          </tr>
        </table>
      </div>
      <!-- KEY CONFIGURATION -->
    </form>
  </body>
</html>
